# 🦾 저지연 실시간 동작 모방 로봇팔 (Low-Latency Motion Mimicking Robot Arm)

> **"Zero-Copy IPC 기술과 인체 해부학적 설계를 적용한 7-DOF 초저지연 로봇 제어 시스템"**

본 프로젝트는 사용자의 상체 및 손가락 움직임을 실시간으로 감지하여 원격 로봇팔에 동기화하는 시스템입니다.
단순한 동작 전달을 넘어, 통신 지연을 극단적으로 낮추고 하드웨어 제약 사항을 창의적으로 해결하는 데 중점을 두었습니다. 

---

## 📺 시연 영상 (Demo)


https://github.com/user-attachments/assets/3fd31e2d-bc2d-43b3-9ffc-f364335191a9


## ✨ 핵심 기술 및 특징

### 1. 초저지연 통신 아키텍처
**Zero-Copy IPC:** Python의 GIL 문제를 극복하기 위해 **멀티프로세싱 및 공유 메모리(Shared Memory)** 기법을 도입하여 데이터 복사 오버헤드를 최소화했습니다. 
**하이브리드 통신:** Bluetooth SPP와 유선 Serial을 결합하여 실측 편도 지연 시간(E2E Latency) 약 **7.5ms**를 달성했습니다. 
* **정밀 RTT 검증:** 시스템 지연시간을 정량적으로 측정하기 위한 Full E2E 측정 시스템을 구축했습니다.
  * [RTT 측정 원리 및 패킷 구조 상세 보기](./docs/RTT_Measurement.md)

### 2. 인체 모방형 하드웨어 설계
**견갑골 슬라이딩 구조:** 어깨 관절의 수평 외전/내전 시 발생하는 견갑골의 움직임을 수용하기 위해 **레일형 슬라이딩 기구부**를 설계했습니다.
**와이어 구동 로봇손:** 인체의 전완 근육과 힘줄 구조를 모방하여 서보모터가 와이어를 당겨 손가락을 굽히는 방식을 채택했습니다.

### 3. 실시간 성능 모니터링 대시보드
**Streamlit Dashboard:** 로봇의 3D 궤적, 패킷 전송률(Hz), 실시간 지연시간(ms)을 웹 환경에서 시각화하여 모니터링합니다.

---

## 🏗 시스템 구성 (System Architecture)

1. **송신부:** 3축 관절 각도 및 4축 손가락 상태 수집 (STM32 F446RE) 
2. **통신부:** Bluetooth SPP를 통한 데이터 무선 전송 (ESP32) 
3. **중계부:** 공유 메모리 기반 데이터 처리 및 시각화 (Python)
4. **수신부:** 7-DOF 서보모터 구동 및 실시간 RTT 측정용 ACK 반환 (STM32)

---

## 🚀 문제 해결 사례 (Troubleshooting)

### ✅ 유연 센서(Flex Sensor) 불량을 호일 센서로 대체
**문제:** 굽힘 센서의 감도 문제로 손가락 동작 인식이 불가능했습니다. 
**해결:** 알루미늄 호일과 **풀업(Pull-up) 저항** 원리를 이용해 손가락과 손바닥이 닿으면 회로가 닫히는 접촉식 스위치를 독자적으로 고안했습니다. 

### ✅ 엔코더 열 손상을 ADC 가변저항으로 극복
**문제:** 제작 중 발생한 열로 절대형 엔코더가 손상되어 데이터 오류가 발생했습니다. 
**해결:** 즉각 **가변저항을 이용한 ADC 맵핑 방식**으로 설계를 변경하여 정밀한 각도 데이터를 확보했습니다. 

### ✅ 견갑골 유동성을 고려한 기구 설계 보완
**문제:** 어깨 관절 고정 시 인체 가동 범위 제한 및 축 불일치 문제 발생. 
**해결:** **레일형 슬라이딩 이너 브라켓**을 도입하여 견갑골의 횡 운동을 수용하도록 개조했습니다.


https://github.com/user-attachments/assets/aa561d97-5bb9-4131-8da4-cb2683c8361c


---

## 📊 데이터 패킷 구조 (15 Bytes)

| 필드 | 바이트 | 설명 |
| :--- | :--- | :--- |
| **Header** | 0-1 | 0xAA, 0x55 (고정 헤더) |
| **Angle 1-3** | 2-7 | 3축 각도 정보 (signed int16) |
| **Finger 1-4** | 8-11 | 4개 손가락 상태 (uint8) |
| **RTT** | 12-13 | 왕복 지연 시간 (ms) |
| **Checksum** | 14 | 데이터 무결성 검증용 LSB 합 |
